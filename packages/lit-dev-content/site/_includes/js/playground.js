const e={name:100,mode:8,uid:8,gid:8,size:12,mtime:12,chksum:8,typeflag:1,linkname:100,magic:5,version:2,uname:32,gname:32,devmajor:8,devminor:8,prefix:155,padding:12},t={};Object.keys(e).reduce(((n,a)=>(t[a]=n,n+e[a])),0);const n=["name","linkname","magic","chksum","typeflag","version","uname","gname"];function a(e,t){return("000000000000"+(e=e.toString(8))).slice(e.length+12-t)}function o(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}window.addEventListener("DOMContentLoaded",(()=>{const s=document.body.querySelector.bind(document.body),c=s("playground-ide"),i=s(".examples-button"),r=s(".examples-drawer");i.addEventListener("click",(()=>{r.classList.toggle("open"),r.classList.add("transitioning")})),r.addEventListener("transitionend",(()=>{r.classList.remove("transitioning")}));const d=s(".share-button"),l=s(".share-snackbar");d.addEventListener("click",(async()=>{const e=Object.entries(c.config?.files??{}).map((([e,t])=>({name:e,content:t.content}))),t=(e=>{const t=encodeURIComponent(e).replace(/%([0-9A-F]{2})/g,((e,t)=>String.fromCharCode(parseInt(t,16)))),n=btoa(t).replace(/\+/g,"-").replace(/\//g,"_"),a=n.indexOf("=");return a>=0?n.slice(0,a):n})(JSON.stringify(e));window.location.hash="#project="+t,await navigator.clipboard.writeText(window.location.toString()),l.show()})),s(".download-button").addEventListener("click",(()=>{const s=Object.entries(c.config?.files??{}).map((([e,{content:t}])=>({name:e,content:t??""}))),i=s.reduce(((s,c)=>{"string"==typeof c.content&&(c.content=o(c.content)),c=Object.assign((e=>({name:e.name,mode:"777",uid:0,gid:0,size:e.content.byteLength,mtime:Math.floor(Number(new Date)/1e3),chksum:"        ",typeflag:"0",magic:"ustar",version:"  ",uname:"",gname:""}))(c),c);const i=new Uint8Array(512*Math.ceil((512+c.size)/512)),r=Object.keys(e).reduce(((s,r)=>{if(!(r in c))return s;const d=o(n.indexOf(r)>-1?c[r]:a(c[r],e[r]-1));return i.set(d,t[r]),s+d.reduce(((e,t)=>e+t),0)}),0);i.set(o(a(r,7)),t.chksum),i.set(c.content,512);const d=new Uint8Array(s.byteLength+i.byteLength);return d.set(s,0),d.set(i,s.byteLength),d}),new Uint8Array(0)),r=document.createElement("a");r.href=URL.createObjectURL(new Blob([i],{type:"application/tar"})),r.download="lit-playground.tar",r.click()}));const m=()=>{const e=window.location.hash,t=new URLSearchParams(e.slice(1));let n;const a=t.get("project");if(a)try{const e=(e=>{const t=e.replace(/-/g,"+").replace(/_/g,"/"),n=atob(t).split("").map((e=>"%"+e.charCodeAt(0).toString(16).padStart(2,"0"))).join("");return decodeURIComponent(n)})(a);try{n=JSON.parse(e)}catch{console.error("Invalid JSON in URL",JSON.stringify(e))}}catch{console.error("Invalid project base64 in URL")}if(s(".sample-link.active")?.classList.remove("active"),n)c.config={extends:"/samples/base.json",files:Object.fromEntries(n.map((({name:e,content:t})=>[e,{content:t}])))};else{let e="examples/hello-world-typescript",n=!1;const a=t.get("sample");a?.match(/^[a-zA-Z0-9_\-\/]+$/)&&(e=a,a.startsWith("examples/")&&(n=!0)),c.projectSrc=`/samples/${e}/project.json`;const o=s(`.sample-link[data-sample="${e}"]`);o&&(o.classList.add("active"),requestAnimationFrame((()=>{o.scrollIntoViewIfNeeded?.()}))),n&&r.classList.add("open")}};m(),window.addEventListener("hashchange",m)}));
